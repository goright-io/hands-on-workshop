import Layout from "../../templates/layout"

export default Layout
export const meta = { title: "Build and Deployment" }



## Updating design tokens

If you want to sync with the design library, build Figma tokens.
You will use in components and product pages.
The tokens are exported from Figma in one click with
[Design Tokens plugin](https://github.com/lukasoppermann/design-tokens), but the default
export file is not very convenient for development
 The purpose of _Tokens workspace_ is simply to transform exported JSON into
 JS object of a convenient shape.

Get the design tokens JSON
file from your designer, put it as `tokens/design-tokens.json` into
the repository. Then, build the tokens

```
yarn tokens:build
```

This command changes the files in `tokens/dist` directory. Normally, you would
distribute them as an npm package for all to sync. But in the workshop, for
the sake of simplicity, we are keeping it in the repository. In this case, you
have to commit the changes for your other team member's to sync.



## Adding new component

Quickly add component template files:

```
yarn add-component <ComponentName>
```

For example, if you run `yarn add-component Avatar`, a new folder with two new files will be created at `design-system/src/components`:

- Avatar/
  - index.js
  - Avatar.stories.mdx



## Building and releasing library

Do not forget that we serve design tokens and the library of components as different
packages. However, it is good to keep them synced and always release the tokens when
you are releasing the library.

### Release the tokens

```
yarn tokens:version
```

The release script will build the tokens, increment the version and commit the
result of the build. If you want to check beforehand that the build is not broken,
run `tokens:build`.

### Upgrade the tokens version in the library

Go to package.json of your design system (`design-system/package.json`) and change the
version of the library:

```diff
  "dependencies": {
-   "tokens": "0.1.0", 
+   "tokens": "0.2.0",
  ...
  }

```

### Release the library

When the tokens are updated, all the changes are commited,
you can release your library:


```
yarn design-system:version
```

Similarly to the process with tokens, you will be prompted to type a version.
Alongside with incrementing the version, this command builds the library and
commits the result to the repository. If you want to check beforehand that the
build goes normally, run `yarn design-system:build`.

**Now you can use the new library version in the product.**

### Additional information

When releasing the tokens or the library, you can run the command with one of
the flags: `--patch`, `--minor`, `--major`. They will fill the coresponding
version number accordingly.


### Why we are keeping dist in the repo?

When we are building the tokens or the library, their minified prduction-ready versions
are  created in `tokens/dist` and `design-system/dist` folders.
Normally, such folders would not be a part of your repository. You would keep them inside the
npm packages. But in the workshop, we keep it simple: you sync with your other
team members by commiting the compiled files into the reposiitory.

